<%
  title 'Messages'
%>

<div class="page-header">
  <h1>
    <%= form_tag search_community_messages_path, method: :get do %>
      <div class="input-group pull-right search-message-group">
        <%= text_field_tag 'term', nil, class: 'form-control', placeholder: 'Search' %>
        <div class="input-group-btn">
          <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button>
        </div>
      </div>
    <% end %>
    <span>Messages</span>
  </h1>
</div>

<div class='row messages-panel'>
  <div class='col-md-4 messages-panel__participant'>
    <% @members.find_each do |member| %>
      <div class="chat-participant <%= 'active' if member == @receiver %>">
        <%= link_to community_member_messages_path(current_community, member), class: 'chat-participant__link' do %>
          <div class="media">
            <div class="media-left">
              <%= image_tag member.avatar.small_thumb.url, class: 'media-object' %>
            </div>
            <div class="media-body">
              <h4 class="media-heading"><%= member.full_name %></h4>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
  <div class='col-md-8'>
    <div class='messages-panel__conversations'>
      <%= render partial: 'message', collection: @messages %>
    </div>
    <div class='messages-panel__form'>
      <%= simple_form_for([current_community, @receiver, Message.new]) do |f| %>
        <div>
          <%= f.input :body, label: false %>
          <%= f.submit 'Send', class: 'btn btn-default' %>
        </div>
      <% end %>
    </div>
  </div>
</div>
